# Exact Deployment Commands

## Copy-Paste Ready Commands

### 1. Test Locally (Before Deploying)

```bash
# Navigate to demodev directory
cd demodev

# Run Gunicorn with the correct WSGI module
gunicorn demodev.wsgi:application

# Expected output:
# [2024-12-10 12:34:56 +0000] [12345] [INFO] Starting gunicorn 23.0.0
# [2024-12-10 12:34:56 +0000] [12345] [INFO] Listening at: http://127.0.0.1:8000 (12345)
# [2024-12-10 12:34:56 +0000] [12345] [INFO] Using worker: sync
# [2024-12-10 12:34:57 +0000] [12346] [INFO] Worker spawned (pid: 12346)

# Press Ctrl+C to stop
```

### 2. Commit and Push to GitHub

```bash
# Stage all deployment files
git add runtime.txt requirements.txt demodev/render.yaml demodev/Procfile

# Commit with descriptive message
git commit -m "Fix Render deployment: Python 3.11, correct Gunicorn paths, cleaned dependencies"

# Push to main branch
git push origin main

# Verify push was successful
git log --oneline -5
```

### 3. Render Dashboard Configuration

**Build Command (copy exactly):**
```
cd demodev && pip install -r ../requirements.txt && python manage.py collectstatic --noinput && python manage.py migrate
```

**Start Command (copy exactly):**
```
cd demodev && gunicorn demodev.wsgi:application
```

**Environment Variables (set these):**
```
DEBUG=False
SECRET_KEY=<auto-generated by Render>
DATABASE_URL=<auto-populated by Render>
ALLOWED_HOSTS=*.onrender.com,localhost,127.0.0.1
```

---

## Step-by-Step Deployment

### Step 1: Local Verification (5 minutes)

```bash
# 1a. Navigate to project
cd /path/to/DjangoFinal

# 1b. Check files exist
ls -la runtime.txt
ls -la requirements.txt
ls -la demodev/render.yaml
ls -la demodev/Procfile

# 1c. Test Gunicorn locally
cd demodev
gunicorn demodev.wsgi:application

# 1d. If successful, press Ctrl+C to stop
# 1e. Navigate back to root
cd ..
```

### Step 2: Git Commit and Push (2 minutes)

```bash
# 2a. Check git status
git status

# 2b. Stage files
git add runtime.txt requirements.txt demodev/render.yaml demodev/Procfile

# 2c. Verify staged files
git status

# 2d. Commit
git commit -m "Fix Render deployment: Python 3.11, correct Gunicorn paths, cleaned dependencies"

# 2e. Push to GitHub
git push origin main

# 2f. Verify push
git log --oneline -1
```

### Step 3: Render Dashboard Deploy (10-15 minutes)

1. Go to https://dashboard.render.com
2. Select your web service
3. Click "Manual Deploy" button
4. Wait for deployment to complete
5. Monitor logs in "Logs" tab

### Step 4: Verify Deployment (5 minutes)

```bash
# Test the deployed app
# Replace 'your-app-name' with your actual Render app name

# 4a. Test homepage
curl https://your-app-name.onrender.com/

# 4b. Test admin panel
curl https://your-app-name.onrender.com/admin/

# 4c. Test API
curl https://your-app-name.onrender.com/api/

# 4d. Open in browser
# https://your-app-name.onrender.com
# https://your-app-name.onrender.com/admin
# https://your-app-name.onrender.com/api/
```

---

## File Contents (For Reference)

### runtime.txt
```
python-3.11.9
```

### requirements.txt
```
Django==4.2
djangorestframework==3.16.1
django-cors-headers==4.9.0
dj-database-url==3.0.1
python-decouple==3.8
python-dotenv==1.1.1
gunicorn==23.0.0
whitenoise==6.11.0
psycopg2-binary==2.9.11
Pillow==11.1.0
channels==4.0.0
channels-redis==4.1.0
redis==6.2.0
hypothesis==6.148.7
pytest==9.0.2
pytest-django==4.7.0
```

### demodev/Procfile
```
web: gunicorn demodev.wsgi:application
release: python manage.py migrate
```

### demodev/render.yaml (key sections)
```yaml
buildCommand: cd demodev && pip install -r ../requirements.txt && python manage.py collectstatic --noinput && python manage.py migrate
startCommand: cd demodev && gunicorn demodev.wsgi:application
```

---

## Troubleshooting Commands

### If deployment fails, run these locally:

```bash
# Check Python version
python --version

# Check if Gunicorn is installed
pip show gunicorn

# Check if Django is installed
pip show Django

# Try importing the WSGI module
cd demodev
python -c "from demodev.wsgi import application; print('WSGI module loaded successfully')"

# Check if manage.py works
python manage.py check

# Check if migrations are needed
python manage.py showmigrations

# Run migrations locally
python manage.py migrate

# Collect static files locally
python manage.py collectstatic --noinput

# Try Gunicorn again
gunicorn demodev.wsgi:application
```

---

## Verification Checklist Commands

```bash
# Verify all files exist
echo "Checking files..."
test -f runtime.txt && echo "✓ runtime.txt exists" || echo "✗ runtime.txt missing"
test -f requirements.txt && echo "✓ requirements.txt exists" || echo "✗ requirements.txt missing"
test -f demodev/render.yaml && echo "✓ demodev/render.yaml exists" || echo "✗ demodev/render.yaml missing"
test -f demodev/Procfile && echo "✓ demodev/Procfile exists" || echo "✗ demodev/Procfile missing"

# Verify Python version in runtime.txt
echo "Python version:"
cat runtime.txt

# Verify no Windows packages in requirements.txt
echo "Checking for Windows packages..."
grep -i "pywin32\|win32" requirements.txt && echo "✗ Windows packages found!" || echo "✓ No Windows packages"

# Verify Gunicorn is in requirements.txt
echo "Checking for Gunicorn..."
grep "gunicorn" requirements.txt && echo "✓ Gunicorn found" || echo "✗ Gunicorn missing"

# Verify Django is in requirements.txt
echo "Checking for Django..."
grep "Django" requirements.txt && echo "✓ Django found" || echo "✗ Django missing"
```

---

## Expected Output After Successful Deployment

### Render Logs Should Show:
```
==> Running 'cd demodev && pip install -r ../requirements.txt && python manage.py collectstatic --noinput && python manage.py migrate'
Collecting Django==4.2
...
Successfully installed Django-4.2 ...
...
Operations to perform:
  Apply all migrations: admin, auth, contenttypes, sessions, tweet
Running migrations:
  Applying ... OK
...
==> Running 'cd demodev && gunicorn demodev.wsgi:application'
[TIMESTAMP] [PID] [INFO] Starting gunicorn 23.0.0
[TIMESTAMP] [PID] [INFO] Listening at: http://0.0.0.0:10000 (PID)
[TIMESTAMP] [PID] [INFO] Using worker: sync
[TIMESTAMP] [PID] [INFO] Worker spawned (pid: XXXX)
```

### App Should Be Accessible At:
```
https://your-app-name.onrender.com
https://your-app-name.onrender.com/admin
https://your-app-name.onrender.com/api/
```

---

## Quick Rollback (If Needed)

If deployment fails and you need to rollback:

```bash
# Revert last commit
git revert HEAD

# Or reset to previous commit
git reset --hard HEAD~1

# Push the revert
git push origin main

# Trigger manual deploy in Render
```

---

## Support

If you encounter issues:

1. Check Render logs: https://dashboard.render.com → Your Service → Logs
2. Run local tests: `cd demodev && gunicorn demodev.wsgi:application`
3. Verify environment variables in Render dashboard
4. Check `requirements.txt` for compatibility issues
5. Ensure `runtime.txt` has `python-3.11.9`

---

**Ready? Start with Step 1: Local Verification**
